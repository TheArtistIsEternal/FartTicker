
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fart TickerğŸ’¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #111;
      --fg: #fff;
    }
    [data-theme="light"] {
      --bg: #fff;
      --fg: #111;
    }
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 2em;
      background: var(--bg);
      color: var(--fg);
      transition: background 0.3s, color 0.3s;
    }
    h1 {
      font-size: 2.2em;
      margin-bottom: 0.3em;
      position: relative;
    }
    .trail::after {
      content: "ğŸ’¨";
      position: absolute;
      left: 100%;
      top: 0;
      animation: puff 3s infinite;
      font-size: 1.5em;
    }
    @keyframes puff {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      100% { transform: translateY(-50px) scale(1.8); opacity: 0; }
    }
    #description {
      font-size: 0.9em;
      margin: 0.5em 0 1em;
      color: gray;
    }
    #prices { margin: 1em 0; }
    .ticker-buttons button {
      margin: 0.5em;
      padding: 0.7em 1.2em;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      background: #222;
      color: #fff;
      cursor: pointer;
    }
    .ticker-buttons button:hover {
      background: lime;
      color: black;
    }
    button#play {
      margin-top: 2em;
      padding: 1em 2em;
      font-size: 1.2em;
      background: lime;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .donate, .share, .controls { margin-top: 2em; }
    .share button, .controls button {
      margin: 0.25em;
      padding: 0.5em 1em;
      background: #444;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .animation {
      margin-top: 1em;
      font-size: 2em;
      display: none;
    }
    .show { display: block; animation: float 1s ease-out; }
    @keyframes float {
      0% { transform: translateY(0); opacity: 0; }
      50% { opacity: 1; }
      100% { transform: translateY(-20px); opacity: 0; }
    }
  </style>
</head>
<body data-theme="dark">

  <h1 class="trail">Fart Ticker ğŸ’¨</h1>
  <div id="description">This page turns crypto price changes into fart sounds.</div>
  <div id="tagline" style="font-style:italic; margin-top:0.5em; color:gray;"></div>

  <div class="ticker-buttons">
    <button onclick="setAsset('bitcoin')">ğŸš€ Bitcoin</button>
    <button onclick="setAsset('ethereum')">â™¦ Ethereum</button>
    <button onclick="setAsset('dogecoin')">ğŸ¶ Dogecoin</button>
    <button onclick="setAsset('solana')">ğŸŒ Solana</button>
  </div>

  <div id="prices"><p>Loading...</p></div>

  <div class="controls">
    <button onclick="setAsset(currentAsset)">ğŸ”„ Refresh</button>
    <button id="pitchToggle" onclick="togglePitch()">ğŸ’ƒ For the Ladies</button>
  </div>

  <button id="play" onclick="playStretched()">â–¶ï¸ Hear the Price Change</button>

  <div class="animation" id="animation">ğŸ’¨ğŸ’¸</div>

  <div class="donate">
    <a href="https://buy.stripe.com/cNi6oJevgdUi0ZR5TogrS00" target="_blank">
      <button style="padding:1em 2em; font-size:1.2em; background:#00d084; color:#111; border:none; border-radius:8px; cursor:pointer;">
        ğŸ’¸ Support via Stripe
      </button>
    </a>
  </div>

  <div class="share">
    <button onclick="share('twitter')">Share on Twitter</button>
    <button onclick="share('facebook')">Share on Facebook</button>
    <button onclick="share('reddit')">Share on Reddit</button>
    <button onclick="copyLink()">ğŸ“ Copy Website Link</button>
  </div>

  <div style="margin-top: 2em;">
    <button onclick="toggleTheme()" style="padding: 0.5em 1em;">ğŸŒ“ Toggle Theme</button>
  </div>

  <footer style="margin-top:3em; font-size:0.8em; color:gray;">
    Â© FartTicker.com 2025 ğŸ’¨ All rights reserved.
  </footer>

  <script>
    const taglines = [
      "Todayâ€™s market movement? Downwind.",
      "Farted +3.4% overnight.",
      "Holding strong... like last nightâ€™s burrito.",
      "Markets passed gas. Did you hear it?",
      "When crypto moves, we toot.",
      "Sound investing, literally.",
      "Wall Streetâ€™s whoopee cushion.",
      "The only ticker that stinks by design.",
      "Flatulent but accurate.",
      "Todayâ€™s sound? Full-bodied."
    ];
    document.addEventListener('DOMContentLoaded', () => {
      const tagline = taglines[Math.floor(Math.random() * taglines.length)];
      document.getElementById('tagline').textContent = tagline;
    });

    let percentChange = 0;
    let currentAsset = 'bitcoin';

    async function fetchCoinGecko(asset) {
      const res = await fetch(`https://api.coingecko.com/api/v3/coins/${asset}`);
      const data = await res.json();
      const price = data.market_data.current_price.usd;
      const change = data.market_data.price_change_percentage_24h;
      const yesterday = price / (1 + change / 100);
      percentChange = parseFloat(change.toFixed(2));
      document.getElementById('prices').innerHTML = `
        <p>ğŸ“ˆ ${asset.toUpperCase()}</p>
        <p>ğŸ’° Current Price: $${price.toFixed(2)}</p>
        <p>ğŸ•’ Yesterday's Price: $${yesterday.toFixed(2)}</p>
        <p><strong>Change: ${percentChange}%</strong></p>
      `;
    }

    function setAsset(asset) {
      currentAsset = asset;
      fetchCoinGecko(asset);
    }

    async function playStretched() {
      if (window.source) {
        try { window.source.stop(); } catch(e) {}
        window.source.disconnect();
      }
      if (window.audioContext) {
        window.audioContext.close().catch(() => {});
      }
      const audioContext = new AudioContext();
      window.audioContext = audioContext;

      const isUp = percentChange >= 0;
      const file = isUp ? 'FART_1SEC_FORWARD.mp3' : 'FART_1SEC_REVERSE.mp3';
      const response = await fetch(file);
      const arrayBuffer = await response.arrayBuffer();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);

      const source = audioContext.createBufferSource();
      window.source = source;
      source.buffer = audioBuffer;
      source.playbackRate.value = (pitchUp ? 2 : 1) / (1 + Math.abs(percentChange));
      source.connect(audioContext.destination);
      source.start();

      document.getElementById('animation').classList.add('show');
      setTimeout(() => document.getElementById('animation').classList.remove('show'), 1000);
    }

    function toggleTheme() {
      const body = document.body;
      body.dataset.theme = body.dataset.theme === "light" ? "dark" : "light";
    }

    function share(platform) {
      const url = encodeURIComponent("https://fartticker.com");
      const text = encodeURIComponent("Hear todayâ€™s market move as a fart: ");
      const links = {
        twitter: `https://twitter.com/intent/tweet?text=${text}&url=${url}`,
        facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`,
        reddit: `https://www.reddit.com/submit?url=${url}&title=${text}`
      };
      window.open(links[platform], "_blank");
    }

    function copyLink() {
      navigator.clipboard.writeText("https://fartticker.com")
        .then(() => alert("Link copied! ğŸ’¨"))
        .catch(() => alert("Couldn't copy link."));
    }

    setAsset('bitcoin');
  </script>
</body>
</html>

<script>
  let pitchUp = false;

  function togglePitch() {
    pitchUp = !pitchUp;
    const btn = document.getElementById("pitchToggle");
    btn.textContent = pitchUp ? "ğŸ•º Back to the Boys" : "ğŸ’ƒ For the Ladies";
  }
</script>
