
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fart TickerðŸ’¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root {
      --bg: #111;
      --fg: #fff;
    }
    [data-theme="light"] {
      --bg: #fff;
      --fg: #111;
    }
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 2em;
      background: var(--bg);
      color: var(--fg);
      transition: background 0.3s, color 0.3s;
    }
    h1 {
      font-size: 2.2em;
      margin-bottom: 0.3em;
      position: relative;
    }
    .trail {
      display: inline-block;
      position: relative;
    }
    .trail::after {
      content: "ðŸ’¨";
      position: absolute;
      left: 100%;
      top: 0;
      animation: puff 3s infinite;
      font-size: 1.5em;
    }
    @keyframes puff {
      0% { transform: translateY(0) scale(1); opacity: 1; }
      100% { transform: translateY(-50px) scale(1.8); opacity: 0; }
    }
    #description {
      font-size: 0.9em;
      margin: 0.5em 0 1em;
      color: gray;
    }
    #prices { margin: 1em 0; }
    .ticker-buttons button {
      margin: 0.5em;
      padding: 0.7em 1.2em;
      font-size: 1em;
      border: none;
      border-radius: 8px;
      background: #222;
      color: #fff;
      cursor: pointer;
    }
    .ticker-buttons button:hover {
      background: lime;
      color: black;
    }
    button#play {
      margin-top: 2em;
      padding: 1em 2em;
      font-size: 1.2em;
      background: lime;
      border: none;
      border-radius: 8px;
      cursor: pointer;
    }
    .donate, .share, .controls { margin-top: 2em; }
    .share button, .controls button {
      margin: 0.25em;
      padding: 0.5em 1em;
      background: #444;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    .animation {
      margin-top: 1em;
      font-size: 2em;
      display: none;
    }
    .show { display: block; animation: float 1s ease-out; }
    @keyframes float {
      0% { transform: translateY(0); opacity: 0; }
      50% { opacity: 1; }
      100% { transform: translateY(-20px); opacity: 0; }
    }
  </style>
</head>
<body data-theme="dark">

  <h1 class="trail">Fart Ticker</h1>
  <div id="description">This page turns crypto price changes into fart sounds.</div>

  <div class="ticker-buttons">
    <button onclick="setAsset('bitcoin')">ðŸš€ Bitcoin</button>
    <button onclick="setAsset('ethereum')">â™¦ Ethereum</button>
  </div>

  <div id="prices"><p>Loading...</p></div>

  <div class="controls">
    <button onclick="setAsset(currentAsset)">ðŸ”„ Refresh</button>
    <button onclick="toggleTheme()">ðŸŒ“ Toggle Theme</button>
  </div>

  <button id="play" onclick="playStretched()">Hear the Price Change ðŸ’¨</button>

  <div class="animation" id="animation">ðŸ’¨ðŸ’¸</div>

  <div class="donate">
    <a href="https://buy.stripe.com/cNi6oJevgdUi0ZR5TogrS00" target="_blank">
      <button style="padding:1em 2em; font-size:1.2em; background:#00d084; color:#111; border:none; border-radius:8px; cursor:pointer;">
        ðŸ’¸ Support via Stripe
      </button>
    </a>
  </div>

  <div class="share">
    <button onclick="share('twitter')">Share on Twitter</button>
    <button onclick="share('facebook')">Share on Facebook</button>
    <button onclick="share('reddit')">Share on Reddit</button>
  </div>

  <script>
    let percentChange = 0;
    let currentAsset = 'bitcoin';

    async function fetchCoinGecko(asset) {
      const res = await fetch(`https://api.coingecko.com/api/v3/coins/${asset}`);
      const data = await res.json();
      const price = data.market_data.current_price.usd;
      const change = data.market_data.price_change_percentage_24h;
      const yesterday = price / (1 + change / 100);
      percentChange = parseFloat(change.toFixed(2));
      document.getElementById('prices').innerHTML = `
        <p>ðŸ“ˆ ${asset.toUpperCase()}</p>
        <p>ðŸ’° Current Price: $${price.toFixed(2)}</p>
        <p>ðŸ•’ Yesterday's Price: $${yesterday.toFixed(2)}</p>
        <p><strong>Change: ${percentChange}%</strong></p>
      `;
    }

    function setAsset(asset) {
      currentAsset = asset;
      fetchCoinGecko(asset);
    }

    async function playStretched() {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const isUp = percentChange >= 0;
      const file = isUp ? 'FART_1SEC_FORWARD.mp3' : 'FART_1SEC_REVERSE.mp3';
      const response = await fetch(file);
      const arrayBuffer = await response.arrayBuffer();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
      const source = audioContext.createBufferSource();
      source.buffer = audioBuffer;
      source.playbackRate.value = 1 / (1 + Math.abs(percentChange));
      source.connect(audioContext.destination);
      source.start();
      document.getElementById('animation').classList.add('show');
      setTimeout(() => document.getElementById('animation').classList.remove('show'), 1000);
    }

    function toggleTheme() {
      const body = document.body;
      body.dataset.theme = body.dataset.theme === "light" ? "dark" : "light";
    }

    function share(platform) {
      const url = encodeURIComponent("https://fartticker.com");
      const text = encodeURIComponent("Hear todayâ€™s market move as a fart: ");
      const links = {
        twitter: `https://twitter.com/intent/tweet?text=${text}&url=${url}`,
        facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`,
        reddit: `https://www.reddit.com/submit?url=${url}&title=${text}`
      };
      window.open(links[platform], "_blank");
    }

    setAsset('bitcoin');
  </script>

  <!-- Cloudflare Web Analytics -->
  <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "00000000-0000-0000-0000-000000000000"}'></script>
</body>
</html>
