
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Live Fart Ticker (Dramatic)</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 3em; background: #111; color: #fff; }
    h1 { font-size: 2em; }
    #prices { margin: 1em 0; }
    button { margin-top: 2em; padding: 1em 2em; font-size: 1.2em; background: lime; border: none; border-radius: 8px; cursor: pointer; }
    .donate { margin-top: 3em; }
  </style>
</head>
<body>

  <h1>üí® Live Fart Ticker</h1>
  <div id="prices">
    <p>Loading Bitcoin prices...</p>
  </div>

  <button onclick="playStretched()">‚ñ∂Ô∏è Play Sound</button>

  <div class="donate">
    <a href="https://www.buymeacoffee.com/fartticker" target="_blank">
      <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 50px !important;width: 217px !important;">
    </a>
  </div>

  <script>
    let percentChange = 0;

    async function fetchBTCChange() {
      const res = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin');
      const data = await res.json();
      const current = data.market_data.current_price.usd;
      const yesterday = current / (1 + data.market_data.price_change_percentage_24h / 100);
      percentChange = parseFloat(data.market_data.price_change_percentage_24h.toFixed(2));

      document.getElementById('prices').innerHTML = `
        <p>üí∞ Current BTC: $${current.toFixed(2)}</p>
        <p>üïí Yesterday's BTC: $${yesterday.toFixed(2)}</p>
        <p><strong>Live Change: ${percentChange}%</strong></p>
      `;
    }

    async function playStretched() {
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const isUp = percentChange >= 0;
      const file = isUp ? 'FART_1SEC_FORWARD.mp3' : 'FART_1SEC_REVERSE.mp3';
      const response = await fetch(file);
      const arrayBuffer = await response.arrayBuffer();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);

      const source = audioContext.createBufferSource();
      source.buffer = audioBuffer;

      let stretch = 1 + Math.abs(percentChange);
      source.playbackRate.value = 1 / stretch;

      source.connect(audioContext.destination);
      source.start();
    }

    fetchBTCChange();
  </script>
</body>
</html>
